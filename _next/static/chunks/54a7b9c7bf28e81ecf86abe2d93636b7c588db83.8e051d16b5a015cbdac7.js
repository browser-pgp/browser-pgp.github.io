(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"5rCv":function(e,t,n){"use strict";var r=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n("q1tI")),c=(0,r(n("8/g6")).default)(a.default.createElement("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check");t.default=c},KH1D:function(e,t,n){"use strict";var r=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n("q1tI")),c=(0,r(n("8/g6")).default)(a.default.createElement("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"}),"FileCopy");t.default=c},MPUk:function(e,t,n){"use strict";var r=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n("q1tI")),c=(0,r(n("8/g6")).default)(a.default.createElement("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");t.default=c},UOzE:function(e,t,n){"use strict";var r=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n("q1tI")),c=(0,r(n("8/g6")).default)(a.default.createElement("path",{d:"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm0 12H6V10h12v10z"}),"LockOpen");t.default=c},Y0qX:function(e,t,n){"use strict";var r=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n("q1tI")),c=(0,r(n("8/g6")).default)(a.default.createElement("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"}),"Lock");t.default=c},"j+AN":function(e,t,n){"use strict";n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return S}));var r,a=n("rePB"),c=n("ODXe"),u=n("q1tI"),o=n.n(u),i=n("zP5H");!function(e){e[e.Public=0]="Public",e[e.Private=1]="Private"}(r||(r={}));var s=Object(i.a)((function(){return Object(u.useState)({open:!1,keyType:r.Public,fingerprint:"",cb:function(e){return 0}})}));function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f=function(){var e=s.useContainer(),t=Object(c.a)(e,2),n=t[0],r=t[1];return{state:n,setState:r,open:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(t){r((function(n){return p({},n,{open:!0,keyType:e,fingerprint:"",cb:t})}))}))},close:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];r((function(e){return p({},e,{open:!1})})),n.cb(e)}}},d=n("kfFl"),b=n("a49G"),v=n.n(b),g=n("V7QN"),y=n("EHhu"),O=n("i6mb"),m=n("tr08"),h=n("Z3vd"),j=n("R/WZ"),P=n("de8u"),w=n("5rCv"),x=n.n(w),k=o.a.createElement,E=function(e){var t=Object(m.a)();return k("div",{style:{paddingLeft:t.spacing(2)}},k(h.a,{startIcon:k(x.a,null),style:{margin:"6px 0",lineHeight:"24px"},onClick:function(){return e.onFinish()}},"\u5b8c\u6210\u9009\u62e9"))},M=[new g.a("\u540d",(function(e){return e.name})),new g.a("\u90ae\u7bb1",(function(e){return e.email})),new g.a("\u6307\u7eb9",(function(e){return e.fingerprint}))],V=Object(j.a)((function(e){return{table:{wordBreak:"keep-all","& .MuiPaper-root.MuiPaper-elevation1.MuiPaper-rounded":{flexDirection:"row-reverse"},"& .MuiPaper-root.MuiPaper-elevation1.MuiPaper-rounded h6":{paddingRight:e.spacing(3),paddingLeft:0}}}})),C=function(e){var t,n=f(),a=V(),c=Object(O.a)((function(){var t=y.b.users.find();return e.keyType===r.Private&&(t=t.exists("privateKey")),e.fingerprint&&(t=t.where("fingerprint").eq(e.fingerprint)),t.$})),o=(c||[]).map((function(e){return M.map((function(t){return t.opath(e)}))})),i=Object(u.useMemo)((function(){return{selectedUsers:[]}}),[]),s=Object(g.b)({customToolbarSelect:function(e){return k(E,{onFinish:function(){return n.close(i.selectedUsers)}})},selectableRowsOnClick:!0,onRowsSelect:function(e,t){var n=t.map((function(e){return c[e.dataIndex]}));return i.selectedUsers=n,t}});switch(e.keyType){case r.Public:t="\u9009\u62e9\u52a0\u5bc6\u516c\u94a5";break;case r.Private:t="\u9009\u62e9\u89e3\u5bc6\u79c1\u94a5",s.selectableRows="single"}return k(u.Fragment,null,null===c&&k(P.a,null),k("div",{className:a.table,onKeyPress:function(e){"Enter"===e.key&&i.selectedUsers.length>0&&n.close(i.selectedUsers)}},k(v.a,{title:t,columns:M,data:o,options:s})))},D=o.a.createElement,K=function(){var e=f(),t=e.state,n=e.close;return D(d.a,{open:t.open,fullWidth:!0,maxWidth:"md",onClose:function(){return n()}},D(C,{keyType:t.keyType}))},z=o.a.createElement,S=function(e){return z(s.Provider,null,z(K,null),e.children)}},koD6:function(e,t,n){"use strict";n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return s}));var r=n("rePB"),a=n("o0o1"),c=n.n(a),u=n("ODXe"),o=n("q1tI"),i=n("zP5H"),s=Object(i.a)((function(){return Object(o.useState)({})})),l=n("uBBE"),p=n("QYcz");function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b=function(){var e=s.useContainer(),t=Object(u.a)(e,2),n=t[0],a=t[1],o=Object(l.b)();return{getUserPrivateKey:function(e){var t;return c.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:if(n[e.privateKey]){u.next=4;break}return t=Promise.resolve().then((function(){var t,n,r,a,u;return c.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.privateKey,i.next=3,c.a.awrap(o.open(t));case 3:return n=i.sent,i.next=6,c.a.awrap(p.key.readArmored(t));case 6:return r=i.sent,a=r.keys,u=a[0],i.next=11,c.a.awrap(u.decrypt(n));case 11:return i.abrupt("return",u);case 12:case"end":return i.stop()}}),null,null,null,Promise)})),a((function(n){return d({},n,Object(r.a)({},e.privateKey,t))})),u.abrupt("return",t);case 4:return u.abrupt("return",n[e.privateKey]);case 5:case"end":return u.stop()}}),null,null,null,Promise)}}}},rBf2:function(e,t,n){"use strict";n.r(t),n.d(t,"EditorPage",(function(){return L}));var r=n("ODXe"),a=n("q1tI"),c=n.n(a),u=n("uxHW"),o=n("5PFF"),i=n("tRbT"),s=n("kKAo"),l=n("NrVZ"),p=n("Z3vd"),f=n("de8u"),d=n("o0o1"),b=n.n(d),v=n("rePB"),g=n("KQm4"),y=n("zP5H"),O={get content(){return sessionStorage.getItem("tmp-editor-content-store")||""},set content(e){sessionStorage.setItem("tmp-editor-content-store",e)}},m=Object(y.a)((function(){var e=Object(a.useMemo)((function(){var e=o.c.createModel(O.content);return e.onDidChangeContent((function(){O.content=e.getValue()})),e}),[]);return Object(a.useState)({pending:!1,model:e})})),h=n("XFFy"),j=n("j+AN"),P=n("QYcz"),w=n("EHhu"),x=n("koD6"),k=n("jouk");function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var V=n("P5Jw"),C=n.n(V),D=n("HXb3"),K=n("Y0qX"),z=n.n(K),S=n("UOzE"),q=n.n(S),H=n("MPUk"),I=n.n(H),T=n("KH1D"),R=n.n(T),U=n("R/WZ"),_=c.a.createElement,F=Object(U.a)((function(e){return{root:{height:"100%"},editorWrapper:{flexGrow:1},btnWrapper:{padding:e.spacing(2)},hidden:{display:"none"}}})),L=function(){var e=F(),t=function(){var e=m.useContainer(),t=Object(r.a)(e,2),n=t[0],c=t[1],u=Object(j.c)(),i=o.b.useContainer(),s=Object(r.a)(i,1)[0].editor,l=Object(x.b)().getUserPrivateKey,p=Object(k.d)(),f=Object(h.c)("\u52a0\u5bc6"),d=Object(h.c)("\u89e3\u5bc6"),v=Object(h.c)("\u7b7e\u540d"),y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.model.getValue(),t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n.pending){var a=function(){var t,n,a,c,o,i;return b.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,b.a.awrap(u.open(j.a.Private));case 2:if(t=p.sent,n=Object(r.a)(t,1),a=n[0]){p.next=7;break}throw new h.b("\u672a\u9009\u62e9\u5bc6\u94a5");case 7:return p.next=9,b.a.awrap(l(a));case 9:return c=p.sent,p.next=12,b.a.awrap(P.sign({message:P.cleartext.fromText(e),privateKeys:[c]}));case 12:o=p.sent,i=o.data,s.getModel().setValue(i);case 15:case"end":return p.stop()}}),null,null,null,Promise)};return t?a():Promise.resolve(c((function(e){return M({},e,{pending:!0})}))).then(a).catch(v[1]).finally((function(){c((function(e){return M({},e,{pending:!1})}))}))}},O=Object(h.c)("\u786e\u8ba4\u7b7e\u540d"),E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.model.getValue(),t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n.pending){var u=function(){var t,n,c,u,o,i,s,l,f;return b.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,b.a.awrap(w.b.users.find().exec());case 2:return t=d.sent,d.next=5,b.a.awrap(Promise.all(t.map((function(e){var t,n,a;return b.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,b.a.awrap(P.key.readArmored(e.publicKey));case 2:return t=c.sent,n=Object(r.a)(t.keys,1),a=n[0],c.abrupt("return",a);case 6:case"end":return c.stop()}}),null,null,null,Promise)}))));case 5:return n=d.sent,d.t0=b.a,d.t1=P,d.next=10,b.a.awrap(P.cleartext.readArmored(e));case 10:return d.t2=d.sent,d.t3=n,d.t4={message:d.t2,publicKeys:d.t3},d.t5=d.t1.verify.call(d.t1,d.t4),d.next=16,d.t0.awrap.call(d.t0,d.t5);case 16:c=d.sent,c.data,u=c.signatures,s=function(e){var r=n[e],a=u.find((function(e){var t=e.keyid;return r.getKeys(t).length>0}));if(a)return i=a.valid,o=t[e],"break"},l=0;case 21:if(!(l<n.length)){d.next=28;break}if("break"!==s(l)){d.next=25;break}return d.abrupt("break",28);case 25:l++,d.next=21;break;case 28:f=i?"\u7b7e\u540d\u516c\u94a5\u4fe1\u606f":Object(a.createElement)("div",{style:{color:"red"}},"\u7b7e\u540d\u6709\u6548\u4f46\u5185\u5bb9\u5df2\u635f\u574f"),p.open(o.publicKey,f);case 30:case"end":return d.stop()}}),null,null,null,Promise)};return t?u():Promise.resolve(c((function(e){return M({},e,{pending:!0})}))).then(u).catch(O[1]).finally((function(){c((function(e){return M({},e,{pending:!1})}))}))}};return{state:n,encrypt:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.model.getValue();if(!n.pending)return(e=Promise.resolve(c((function(e){return M({},e,{pending:!0})}))).then((function(){var e,n,a,c;return b.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,b.a.awrap(u.open(j.a.Public));case 2:if(!((e=o.sent).length<1)){o.next=5;break}throw new h.b("\u672a\u9009\u62e9\u5bc6\u94a5");case 5:return o.next=7,b.a.awrap(Promise.all(e.map((function(e){var t,n,a;return b.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,b.a.awrap(P.key.readArmored(e.publicKey));case 2:return t=c.sent,n=Object(r.a)(t.keys,1),a=n[0],c.abrupt("return",a);case 6:case"end":return c.stop()}}),null,null,null,Promise)}))));case 7:return n=o.sent,o.next=10,b.a.awrap(P.encrypt({message:P.message.fromText(t),publicKeys:n}));case 10:a=o.sent,c=a.data,s.getModel().setValue(c);case 13:case"end":return o.stop()}}),null,null,null,Promise)}))).then.apply(e,Object(g.a)(f)).finally((function(){c((function(e){return M({},e,{pending:!1})}))}))},decrypt:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.model.getValue();if(!n.pending)return(e=Promise.resolve(c((function(e){return M({},e,{pending:!0})}))).then((function(){var e,n,r,a,c;return b.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,b.a.awrap(u.open(j.a.Private));case 2:if(!((e=o.sent).length<1)){o.next=5;break}throw new h.b("\u672a\u9009\u62e9\u5bc6\u94a5");case 5:return n=e[0],o.next=8,b.a.awrap(l(n));case 8:return r=o.sent,o.t0=b.a,o.t1=P,o.next=13,b.a.awrap(P.message.readArmored(t));case 13:return o.t2=o.sent,o.t3=[r],o.t4={message:o.t2,privateKeys:o.t3},o.t5=o.t1.decrypt.call(o.t1,o.t4),o.next=19,o.t0.awrap.call(o.t0,o.t5);case 19:a=o.sent,c=a.data,s.getModel().setValue(c);case 22:case"end":return o.stop()}}),null,null,null,Promise)}))).then.apply(e,Object(g.a)(d)).finally((function(){c((function(e){return M({},e,{pending:!1})}))}))},sign:y,verify:E,signOrVerify:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.model.getValue();if(!n.pending){var t=O;return Promise.resolve(c((function(e){return M({},e,{pending:!0})}))).then((function(){return b.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,b.a.awrap(P.cleartext.fromText(e));case 3:return n.next=5,b.a.awrap(E(e,!0));case 5:n.next=12;break;case 7:return n.prev=7,n.t0=n.catch(0),n.next=11,b.a.awrap(y(e,!0));case 11:t=v;case 12:case"end":return n.stop()}}),null,null,[[0,7]],Promise)})).catch((function(e){return t[1](e)})).finally((function(){c((function(e){return M({},e,{pending:!1})}))}))}}}}(),n=t.state,c=t.encrypt,d=t.decrypt,v=t.signOrVerify,y=o.b.useContainer(),O=Object(r.a)(y,1)[0].editor,E=Object(D.useSnackbar)().enqueueSnackbar,V=Object(a.useState)(""),K=V[0],S=V[1];return Object(a.useEffect)((function(){O&&(O.updateOptions({readOnly:n.pending}),n.pending||O.focus())}),[n.pending]),Object(a.useEffect)((function(){return n.model.onDidChangeContent((function(){S(n.model.getValue())})),function(){n.model.dispose()}}),[n.model]),_(u.a,{title:"\u7f16\u8f91\u5668",inContainer:!0},_(i.a,{container:!0,direction:"column",className:e.root,component:s.a},_(i.a,{item:!0,className:e.btnWrapper},_(l.a,null,_(C.a,{text:K,onCopy:function(){return E("\u590d\u5236\u6210\u529f")}},_(p.a,{startIcon:_(R.a,null)},"\u590d\u5236")),_(p.a,{disabled:n.pending,onClick:function(){return v()},startIcon:_(I.a,null)},"\u7b7e\u540d/\u6838\u5bf9"),_(p.a,{disabled:n.pending,onClick:function(){return c()},startIcon:_(z.a,null)},"\u52a0\u5bc6"),_(p.a,{disabled:n.pending,onClick:function(){return d()},startIcon:_(q.a,null)},"\u89e3\u5bc6"))),_(i.a,{item:!0},_(f.a,{style:n.pending?{}:{visibility:"hidden"}})),_(i.a,{item:!0,className:e.editorWrapper},_(o.a,{options:{model:n.model}}))))};t.default=function(){return _(m.Provider,null,_(o.b.Provider,null,_(j.b,null,_(k.b,null,_(L,null)))))}}}]);